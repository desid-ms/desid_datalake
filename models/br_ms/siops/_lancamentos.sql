MODEL (
    name siops.lancamentos,
    kind FULL
);
WITH todos_valores as (
    SELECT
        -- CO_MUNICIPIO AS ENTE,
        CO_UF AS ENTE,
        V.NU_ANO,
        V.NU_ANO || CASE 
        WHEN V.NU_PERIODO = '12' THEN '-1'
        WHEN V.NU_PERIODO = '14' THEN '-2'
        WHEN V.NU_PERIODO = '1'  THEN '-3'
        WHEN V.NU_PERIODO = '18' THEN '-4'
        WHEN V.NU_PERIODO = '20' THEN '-5'
        WHEN V.NU_PERIODO = '2'  THEN '-6'
    END AS ANOBIMESTRE,
        V.CO_ITEM,
        V.CO_PASTA,
        V.CO_TIPO,
        V.NU_VALOR
    FROM
        RAW_SIOPS.TB_VL_VALORES V
    INNER JOIN siops__dev.contas_operacionais C ON V.CO_ITEM = C.CO_ITEM
    WHERE V.NU_ANO > 2017
    UNION ALL
    SELECT
        CO_UF AS ENTE,
        V.NU_ANO,
        V.NU_ANO || CASE 
        WHEN V.NU_PERIODO = '12' THEN '-1'
        WHEN V.NU_PERIODO = '14' THEN '-2'
        WHEN V.NU_PERIODO = '1'  THEN '-3'
        WHEN V.NU_PERIODO = '18' THEN '-4'
        WHEN V.NU_PERIODO = '20' THEN '-5'
        WHEN V.NU_PERIODO = '2'  THEN '-6'
    END AS ANOBIMESTRE,
        V.CO_ITEM,
        V.CO_PASTA,
        V.CO_TIPO,
        V.NU_VALOR
    FROM
        RAW_SIOPSUF.TB_VL_VALORES V
    INNER JOIN siops__dev.contas_operacionais C ON V.CO_ITEM = C.CO_ITEM
    WHERE V.NU_ANO > 2017
)  
select c.conta, c.ds_conta, c.tipo_conta, t.ENTE, t.CO_PASTA, t.ANOBIMESTRE, t.nu_valor as VALOR_NOMINAL from todos_valores t 
join siops__dev.contas c on t.co_item = c.codigo_siops
-- Lancamentos AS (
-- SELECT 
--     U."ANO-BIMESTRE", 
--     L.ENTE,
--     I.CO_ITEM_EXIBICAO AS CONTA,
--     L.CO_PASTA,
--     L.CO_TIPO,
--     C.NO_COLUNA AS FASE,
--     L.NU_VALOR AS VALOR_NOMINAL,
--     U.Tx_ID 
-- FROM 
--     Lancamentos L 
--     JOIN SIOPSUF.TB_PROJ_ITEM I ON L.CO_ITEM = I.CO_SEQ_ITEM
--     JOIN SIOPSUF.TB_PROJ_COLUNA C  ON L.CO_TIPO = C.CO_SEQ_COLUNA
--     JOIN UltimaTransmissao U ON 
--         L.NU_ANO = U.NU_ANO 
--         AND L.NU_PERIODO = U.NU_PERIODO 
--         AND L.ENTE = U.ENTE





-- -- ======================================= DESPESAS (ESTADUAL, DF, E MUNICIPAL) ================================================
-- WITH UltimaTransmissao AS ( -- VERIFICANDO SE A HOMOLOGAÇÃO FOI REALIZADA
--     SELECT
--         CO_MUNICIPIO AS ENTE,
--         NU_ANO,
--         NU_PERIODO,
--         MAX(NU_SEQ) AS NU_SEQ
--     FROM
--         SIOPS.TH_AUT_TRANSM
--     WHERE
--         NU_ANO IN ('2018', '2019', '2020', '2021', '2022', '2023')-- VOU VERIFICAR SE ESSA CONSULTA TAMBÉM ATENDERÁ 2024
--         AND ST_HOMOLOGADO = 'S'
--     GROUP BY
--         CO_MUNICIPIO, NU_ANO, NU_PERIODO

--     UNION ALL

--     SELECT
--         CO_UF AS ENTE,
--         NU_ANO,
--         NU_PERIODO,
--         MAX(NU_SEQ) AS NU_SEQ
--     FROM
--         SIOPSUF.TH_AUT_TRANSM
--     WHERE
--         NU_ANO IN ('2018', '2019', '2020', '2021', '2022', '2023') 
--         AND ST_HOMOLOGADO = 'S'
--     GROUP BY
--         CO_UF, NU_ANO, NU_PERIODO
-- )

-- SELECT 
--     V.NU_ANO || CASE 
--         WHEN V.NU_PERIODO = '12' THEN '-1'
--         WHEN V.NU_PERIODO = '14' THEN '-2'
--         WHEN V.NU_PERIODO = '1'  THEN '-3'
--         WHEN V.NU_PERIODO = '18' THEN '-4'
--         WHEN V.NU_PERIODO = '20' THEN '-5'
--         WHEN V.NU_PERIODO = '2'  THEN '-6'
--     END AS "ANO-BIMESTRE",
--     V.CO_MUNICIPIO AS ENTE,
--     C.NO_COLUNA AS FASE,   
--     I.CO_ITEM_EXIBICAO AS CONTA, 
--     SUBSTR(V.CO_PASTA_HIERARQUIA, 1, INSTR(V.CO_PASTA_HIERARQUIA, '_') - 1) AS FONTE,
--     SUBSTR(V.CO_PASTA_HIERARQUIA, INSTR(V.CO_PASTA_HIERARQUIA, '_') + 1) AS SUBFUCAO,
--     V.NU_VALOR AS VALOR_NOMINAL
-- FROM 
--     SIOPS.TB_VL_VALORES V
-- JOIN 
--     SIOPSUF.TB_PROJ_ITEM I ON V.CO_ITEM = I.CO_SEQ_ITEM
-- JOIN 
--     SIOPSUF.TB_PROJ_COLUNA C  ON V.CO_TIPO = C.CO_SEQ_COLUNA 
-- JOIN 
--     UltimaTransmissao U ON V.CO_MUNICIPIO = U.ENTE AND V.NU_ANO = U.NU_ANO AND V.NU_PERIODO = U.NU_PERIODO
-- WHERE
--     V.CO_ITEM NOT IN (
--         '351','352','364','367','368','377','378','387','393','408','418','428',
--         '436','438','439','447','448','462','469','470','471','488','489','490',
--         '501','503','515','523','528','530','536','541','546','553','566','568',
--         '575','585','589','596','597','617','618','626','634','640','648','651',
--         '659','672','686','692','768','769','770','771','774' -- REMOVENDO AS CONTAS TOTALIZADORAS
--     )

--     AND (
-- 		(V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_PASTA_HIERARQUIA IN (
-- 			'3_11', '4_11', '5_11', '6_11', '7_11', '8_11', '9_11', '10_11',
-- 			'3_12', '4_12', '5_12', '6_12', '7_12', '8_12', '9_12', '10_12',
-- 			'3_13', '4_13', '5_13', '6_13', '7_13', '8_13', '9_13', '10_13',
-- 			'3_14', '4_14', '5_14', '6_14', '7_14', '8_14', '9_14', '10_14',
-- 			'3_15', '4_15', '5_15', '6_15', '7_15', '8_15', '9_15', '10_15',
-- 			'3_16', '4_16', '5_16', '6_16', '7_16', '8_16', '9_16', '10_16',
-- 			'3_17', '4_17', '5_17', '6_17', '7_17', '8_17', '9_17', '10_17',
-- 			'3_18', '4_18', '5_18', '6_18', '7_18', '8_18', '9_18', '10_18'
-- 		)) OR 
-- 		(V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_PASTA_HIERARQUIA IN (
-- 			'3_11','4_11','86_11','87_11','88_11','89_11','94_11','95_11','6_11','7_11','8_11','9_11','10_11','90_11',
-- 			'3_12','4_12','86_12','87_12','88_12','89_12','94_12','95_12','6_12','7_12','8_12','9_12','10_12','90_12',
-- 			'3_13','4_13','86_13','87_13','88_13','89_13','94_13','95_13','6_13','7_13','8_13','9_13','10_13','90_13',
-- 			'3_14','4_14','86_14','87_14','88_14','89_14','94_14','95_14','6_14','7_14','8_14','9_14','10_14','90_14',
-- 			'3_15','4_15','86_15','87_15','88_15','89_15','94_15','95_15','6_15','7_15','8_15','9_15','10_15','90_15',
-- 			'3_16','4_16','86_16','87_16','88_16','89_16','94_16','95_16','6_16','7_16','8_16','9_16','10_16','90_16',
-- 			'3_17','4_17','86_17','87_17','88_17','89_17','94_17','95_17','6_17','7_17','8_17','9_17','10_17','90_17',
-- 			'3_18','4_18','86_18','87_18','88_18','89_18','94_18','95_18','6_18','7_18','8_18','9_18','10_18','90_18'
-- 		))
-- 	)
		

-- UNION ALL

-- SELECT 
--     V.NU_ANO || CASE 
--         WHEN V.NU_PERIODO = '12' THEN '-1'
--         WHEN V.NU_PERIODO = '14' THEN '-2'
--         WHEN V.NU_PERIODO = '1'  THEN '-3'
--         WHEN V.NU_PERIODO = '18' THEN '-4'
--         WHEN V.NU_PERIODO = '20' THEN '-5'
--         WHEN V.NU_PERIODO = '2'  THEN '-6'
--     END AS "ANO-BIMESTRE",
--     V.CO_UF AS ENTE,
--     C.NO_COLUNA AS FASE,     
--     I.CO_ITEM_EXIBICAO AS CONTA, 
--     SUBSTR(V.CO_PASTA_HIERARQUIA, 1, INSTR(V.CO_PASTA_HIERARQUIA, '_') - 1) AS FONTE,
--     SUBSTR(V.CO_PASTA_HIERARQUIA, INSTR(V.CO_PASTA_HIERARQUIA, '_') + 1) AS SUBFUCAO,
--     V.NU_VALOR AS VALOR_NOMINAL
-- FROM 
--     SIOPSUF.TB_VL_VALORES V
-- JOIN 
-- 	SIOPSUF.TB_PROJ_ITEM I ON V.CO_ITEM = I.CO_SEQ_ITEM
-- JOIN 
--     SIOPSUF.TB_PROJ_COLUNA C  ON V.CO_TIPO = C.CO_SEQ_COLUNA 
-- JOIN 
-- 	UltimaTransmissao U ON V.CO_UF = U.ENTE AND V.NU_ANO = U.NU_ANO AND V.NU_PERIODO = U.NU_PERIODO
-- WHERE
--     V.CO_ITEM NOT IN (
--         '351','352','364','367','377','393','408','418','428','436','438','439','447','448','452','462',
--         '469','470','471','488','489','490','501','503','515','523','528','536','541','553','566','568',
--         '575','585','589','596','597','617','618','626','634','640','648','651','659','672','686','692',
--         '768','769','770','771','774' -- REMOVENDO AS CONTAS TOTALIZADORAS
--     )

--     AND (
--         (V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_PASTA_HIERARQUIA IN (
--             '3_11', '4_11', '5_11', '6_11', '7_11', '8_11', '9_11', '10_11',
--             '3_12', '4_12', '5_12', '6_12', '7_12', '8_12', '9_12', '10_12',
--             '3_13', '4_13', '5_13', '6_13', '7_13', '8_13', '9_13', '10_13',
--             '3_14', '4_14', '5_14', '6_14', '7_14', '8_14', '9_14', '10_14',
--             '3_15', '4_15', '5_15', '6_15', '7_15', '8_15', '9_15', '10_15',
--             '3_16', '4_16', '5_16', '6_16', '7_16', '8_16', '9_16', '10_16',
--             '3_17', '4_17', '5_17', '6_17', '7_17', '8_17', '9_17', '10_17',
--             '3_18', '4_18', '5_18', '6_18', '7_18', '8_18', '9_18', '10_18'
--         )) OR 
--         (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_PASTA_HIERARQUIA IN (
--             '3_11','4_11','86_11','87_11','88_11','89_11','94_11','95_11','6_11','7_11','8_11','9_11','10_11','90_11',
--             '3_12','4_12','86_12','87_12','88_12','89_12','94_12','95_12','6_12','7_12','8_12','9_12','10_12','90_12',
--             '3_13','4_13','86_13','87_13','88_13','89_13','94_13','95_13','6_13','7_13','8_13','9_13','10_13','90_13',
--             '3_14','4_14','86_14','87_14','88_14','89_14','94_14','95_14','6_14','7_14','8_14','9_14','10_14','90_14',
--             '3_15','4_15','86_15','87_15','88_15','89_15','94_15','95_15','6_15','7_15','8_15','9_15','10_15','90_15',
--             '3_16','4_16','86_16','87_16','88_16','89_16','94_16','95_16','6_16','7_16','8_16','9_16','10_16','90_16',
--             '3_17','4_17','86_17','87_17','88_17','89_17','94_17','95_17','6_17','7_17','8_17','9_17','10_17','90_17',
--             '3_18','4_18','86_18','87_18','88_18','89_18','94_18','95_18','6_18','7_18','8_18','9_18','10_18','90_18'
--         ))
--     )
--     AND V.CO_UF != 53


-- UNION ALL

-- SELECT 
--     V.NU_ANO || CASE 
--         WHEN V.NU_PERIODO = '12' THEN '-1'
--         WHEN V.NU_PERIODO = '14' THEN '-2'
--         WHEN V.NU_PERIODO = '1'  THEN '-3'
--         WHEN V.NU_PERIODO = '18' THEN '-4'
--         WHEN V.NU_PERIODO = '20' THEN '-5'
--         WHEN V.NU_PERIODO = '2'  THEN '-6'
--     END AS "ANO-BIMESTRE",
--     V.CO_UF AS ENTE,
--     C.NO_COLUNA AS FASE,      
--     I.CO_ITEM_EXIBICAO AS CONTA, 
--     SUBSTR(V.CO_PASTA_HIERARQUIA, 1, INSTR(V.CO_PASTA_HIERARQUIA, '_') - 1) AS FONTE,
--     SUBSTR(V.CO_PASTA_HIERARQUIA, INSTR(V.CO_PASTA_HIERARQUIA, '_') + 1) AS SUBFUCAO,
--     V.NU_VALOR AS VALOR_NOMINAL
-- FROM 
--     SIOPSUF.TB_VL_VALORES V
-- JOIN 
-- 	SIOPSUF.TB_PROJ_ITEM I ON V.CO_ITEM = I.CO_SEQ_ITEM
-- JOIN 
--     SIOPSUF.TB_PROJ_COLUNA C  ON V.CO_TIPO = C.CO_SEQ_COLUNA 
-- JOIN 
--     SIOPSUF.TB_PROJ_COLUNA C  ON V.CO_TIPO = C.CO_SEQ_COLUNA 
-- JOIN 
-- 	UltimaTransmissao U ON V.CO_UF = U.ENTE AND V.NU_ANO = U.NU_ANO AND V.NU_PERIODO = U.NU_PERIODO
-- WHERE
--     V.CO_ITEM NOT IN (
--         '351','352','364','367','377','387','393','408','418','428','436','438','439','447','448','462',
--         '469','470','471','488','489','490','501','503','515','523','528','530','536','541','546','553',
--         '566','568','575','596','597','617','618','626','634','640','648','651','659','672','686','692',
--         '768','769','770','771','774' -- REMOVENDO AS CONTAS TOTALIZADORAS
--     )

--     AND (
--         (V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_PASTA_HIERARQUIA IN (
--             '3_11', '4_11', '5_11', '6_11', '7_11', '8_11', '9_11', '10_11',
--             '3_12', '4_12', '5_12', '6_12', '7_12', '8_12', '9_12', '10_12',
--             '3_13', '4_13', '5_13', '6_13', '7_13', '8_13', '9_13', '10_13',
--             '3_14', '4_14', '5_14', '6_14', '7_14', '8_14', '9_14', '10_14',
--             '3_15', '4_15', '5_15', '6_15', '7_15', '8_15', '9_15', '10_15',
--             '3_16', '4_16', '5_16', '6_16', '7_16', '8_16', '9_16', '10_16',
--             '3_17', '4_17', '5_17', '6_17', '7_17', '8_17', '9_17', '10_17',
--             '3_18', '4_18', '5_18', '6_18', '7_18', '8_18', '9_18', '10_18'
--         )) OR 
--         (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_PASTA_HIERARQUIA IN (
--             '3_11','4_11','86_11','87_11','88_11','89_11','94_11','95_11','6_11','7_11','8_11','9_11','10_11','90_11',
--             '3_12','4_12','86_12','87_12','88_12','89_12','94_12','95_12','6_12','7_12','8_12','9_12','10_12','90_12',
--             '3_13','4_13','86_13','87_13','88_13','89_13','94_13','95_13','6_13','7_13','8_13','9_13','10_13','90_13',
--             '3_14','4_14','86_14','87_14','88_14','89_14','94_14','95_14','6_14','7_14','8_14','9_14','10_14','90_14',
--             '3_15','4_15','86_15','87_15','88_15','89_15','94_15','95_15','6_15','7_15','8_15','9_15','10_15','90_15',
--             '3_16','4_16','86_16','87_16','88_16','89_16','94_16','95_16','6_16','7_16','8_16','9_16','10_16','90_16',
--             '3_17','4_17','86_17','87_17','88_17','89_17','94_17','95_17','6_17','7_17','8_17','9_17','10_17','90_17',
--             '3_18','4_18','86_18','87_18','88_18','89_18','94_18','95_18','6_18','7_18','8_18','9_18','10_18','90_18'
--         ))
--     )
--     AND V.CO_UF = 53

-- -- ======================================= RECEITAS ============================================================= 

-- UNION ALL

-- SELECT 
--     V.NU_ANO || CASE 
--         WHEN V.NU_PERIODO = '12' THEN '-1'
--         WHEN V.NU_PERIODO = '14' THEN '-2'
--         WHEN V.NU_PERIODO = '1'  THEN '-3'
--         WHEN V.NU_PERIODO = '18' THEN '-4'
--         WHEN V.NU_PERIODO = '20' THEN '-5'
--         WHEN V.NU_PERIODO = '2'  THEN '-6'
--     END AS "ANO-BIMESTRE",
--     V.CO_MUNICIPIO AS ENTE,
--     C.NO_COLUNA AS FASE,      
--     I.CO_ITEM_EXIBICAO AS CONTA, 
--     '' AS FONTE,
--     '' AS SUBFUCAO,
--     V.NU_VALOR AS VALOR_NOMINAL
-- FROM 
--     SIOPS.TB_VL_VALORES V
-- JOIN 
--     SIOPSUF.TB_PROJ_ITEM I ON V.CO_ITEM = I.CO_SEQ_ITEM
-- JOIN 
--     SIOPSUF.TB_PROJ_COLUNA C  ON V.CO_TIPO = C.CO_SEQ_COLUNA 
-- JOIN 
--     UltimaTransmissao U ON V.CO_MUNICIPIO = U.ENTE AND V.NU_ANO = U.NU_ANO AND V.NU_PERIODO = U.NU_PERIODO
-- WHERE   
--     V.CO_PASTA = 1
--     AND (CASE        
--             WHEN V.CO_TIPO IN ('17','15','18','6','22') --COLUNAS 'Previsão Inicial das Receitas Brutas (a), Previsão Atualizada das Receitas Brutas (b), Receitas Realizadas Brutas (c) e Deduções das Receitas (d), Receitas Orçadas'
--             AND ((V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_ITEM IN (
--                 '16','17','19','20','23','29','30','31','34','35','36','37','38','39','42','44',
--                 '45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60',
--                 '61','62','65','67','69','73','74','75','76','77','78','79','80','81','82','83',
--                 '84','85','86','87','90','91','92','93','95','96','97','98','99','100','101','102',
--                 '108','109','110','111','113','114','116','117','118','119','120','121','122','124',
--                 '125','126','127','128','129','130','132','133','134','135','136','137','138','139',
--                 '143','146','147','148','149','150','151','153','154','155','156','157','158','159',
--                 '160','161','163','164','165','166','167','168','169','170','171','173','174','175',
--                 '177','178','179','181','182','183','184','186','187','188','191','192','194','195',
--                 '196','198','199','200','202','203','204','205','206','207','211','213','214','215',
--                 '216','217','220','221','223','224','225','227','228','229','230','234','235','236',
--                 '238','239','240','241','242','244','246','247','250','251','252','253','257','258',
--                 '259','260','262','263','264','265','266','267','272','273','274','275','276','279',
--                 '280','281','282','283','284','285','291','292','293','294','295','296','297','298',
--                 '299','300','301','303','304','305','306','307','309','310','311','312','313','315',
--                 '316','317','318','320','321','322','323','325','326','327','328','329','332','333',
--                 '335','336','337','339','340','341','342','344','345','346','347','348','349','350',
--                 '706','707','711','714','715','716','717','720','721','722','723','724','725','726',
--                 '727','728','729','730','731','732','733','734','735','736','737','738','739','740',
--                 '741','742','745','746','748','749','751','752','753','754'

--             )) OR 
--             (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_ITEM IN (
--                 '1633','1634','1638','1639','1640','1641','1642','1643','1644','1645','1647','1648','1649','1650','1651','1652',
--                 '1653','1654','1657','1658','1659','1660','1661','1662','1663','1664','1666','1667','1668','1669','1670','1671',
--                 '1672','1673','1674','1675','1677','1678','1681','1682','1683','1684','1685','1687','1688','1689','1690','1692',
--                 '1695','1696','1697','1698','1699','1700','1701','1702','1703','1704','1706','1707','1708','1709','1710','1711',
--                 '1712','1713','1714','1715','1716','1717','1719','1720','1723','1725','1726','1729','1730','1731','1732','1733',
--                 '1734','1735','1738','1741','1742','1743','1744','1745','1746','1748','1749','1750','1751','1752','1753','1754',
--                 '1756','1757','1758','1759','1760','1761','1763','1764','1765','1766','1767','1768','1769','1770','1771','1772',
--                 '1774','1775','1776','1777','1778','1779','1780','1781','1782','1783','1785','1788','1789','1790','1791','1792',
--                 '1793','1795','1796','1797','1798','1799','1800','1801','1803','1804','1805','1806','1808','1810','1811','1813',
--                 '1814','1815','1816','1818','1821','1822','1823','1824','1826','1829','1830','1832','1835','1836','1837','1839',
--                 '1842','1843','1844','1845','1847','1849','1850','1851','1853','1854','1855','1856','1858','1859','1860','1861',
--                 '1862','1863','1864','1865','1866','1867','1868','1869','1870','1871','1872','1876','1877','1878','1881','1882',
--                 '1883','1884','1885','1886','1887','1888','1890','1891','1894','1895','1896','1897','1898','1899','1900','1902',
--                 '1903','1904','1905','1908','1911','1913','1914','1915','1916','1917','1918','1920','1921','1922','1923','1924',
--                 '1925','1926','1928','1929','1930','1931','1932','1933','1934','1935','1937','1939','1940','1941','1943','1944',
--                 '1945','1946','1947','1948','1949','1951','1953','1955','1956','1957','1958','1959','1961','1964','1965','1966',
--                 '1968','1969','1971','1974','1975','1976','1978','1981','1982','1983','1984','1985','1990','1991','1995','1996',
--                 '1997','1998','1999','2000','2001','2002','2004','2005','2006','2007','2008','2009','2010','2011','2014','2015',
--                 '2016','2017','2018','2019','2020','2021','2023','2024','2025','2026','2027','2028','2029','2030','2031','2032',
--                 '2034','2035','2038','2039','2040','2041','2042','2043','2044','2045','2046','2048','2049','2052','2054','2055',
--                 '2058','2059','2060','2061','2062','2063','2064','2065','2066'
--             ))
-- 	)
--         THEN  NVL(V.NU_VALOR, 0)     
        
--         WHEN 
--             V.CO_TIPO = '5' --COLUNA 'Dedução Para Formação do FUNDEB (f)'
--         AND 
--             ((V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_ITEM IN ('16','108','111','137','146','147','148','211','227','250','706')) OR 
--             (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_ITEM IN ('5','113','116','142','160','161','162','362')
--         )
-- 	)
--         THEN  NVL(V.NU_VALOR, 0)     
            
          
--     END = NVL(V.NU_VALOR, 0) )
--      AND V.CO_TIPO NOT IN ('20','24') -- TODOS ITENS DAS COLUNAS SÃO BLOQUEADOS OU SÃO CALCULADOS PELO SISTEMA (Receitas Realizadas da base para cálculo do percentual de aplicacao em ASPS (e) = (c-d), Total Geral das Receitas Liquidas Realizadas (g) = (c-d-f))
-- 	--Obs. Todos os itens da coluna "Total Geral das Receitas Liquidas Realizadas (g) = (c-d-f))" são calculados automaticamente

-- UNION ALL


-- SELECT 
--     V.NU_ANO || CASE 
--         WHEN V.NU_PERIODO = '12' THEN '-1'
--         WHEN V.NU_PERIODO = '14' THEN '-2'
--         WHEN V.NU_PERIODO = '1'  THEN '-3'
--         WHEN V.NU_PERIODO = '18' THEN '-4'
--         WHEN V.NU_PERIODO = '20' THEN '-5'
--         WHEN V.NU_PERIODO = '2'  THEN '-6'
--     END AS "ANO-BIMESTRE",
--     V.CO_UF AS ENTE,
--     C.NO_COLUNA AS FASE,      
--     I.CO_ITEM_EXIBICAO AS CONTA, 
--     '' AS FONTE,
--     '' AS SUBFUCAO,
--     V.NU_VALOR AS VALOR_NOMINAL
-- FROM 
--     SIOPSUF.TB_VL_VALORES V
-- JOIN 
-- 	SIOPSUF.TB_PROJ_ITEM I ON V.CO_ITEM = I.CO_SEQ_ITEM
-- JOIN 
--     SIOPSUF.TB_PROJ_COLUNA C  ON V.CO_TIPO = C.CO_SEQ_COLUNA 
-- JOIN 
-- 	UltimaTransmissao U ON V.CO_UF = U.ENTE AND V.NU_ANO = U.NU_ANO AND V.NU_PERIODO = U.NU_PERIODO   
-- WHERE   
--     V.CO_PASTA = 1
--     AND (CASE        
--             WHEN V.CO_TIPO IN ('17','16','19','7','22') --COLUNAS "Previsão Inicial das Receitas Brutas (a), Previsão Atualizada das Receitas Brutas (c), Receitas  Realizadas Brutas (e),	Deduções das Receitas (f), Receitas Orçadas"
--             AND ((V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_ITEM IN (
--                 '19', '20', '21', '22', '26', '27', '31', '34', '35', '36', '37', '38', '39', '42', '44', '45',
--                 '46', '47', '48', '49', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '60', '61',
--                 '62', '65', '67', '69', '73', '74', '75', '76', '77', '78', '79', '80', '81', '82', '83', '84',
--                 '85', '86', '87', '90', '91', '92', '93', '95', '96', '97', '98', '99', '100', '101', '102', '107',
--                 '112', '113', '114', '116', '117', '118', '119', '120', '121', '122', '124', '125', '126', '127',
--                 '128', '129', '130', '132', '133', '134', '135', '136', '137', '138', '139', '143', '149', '150',
--                 '151', '153', '154', '155', '156', '157', '158', '159', '160', '161', '163', '164', '165', '166',
--                 '167', '168', '169', '170', '171', '173', '174', '175', '177', '178', '179', '181', '182', '183',
--                 '184', '186', '187', '188', '191', '192', '194', '195', '196', '198', '199', '200', '202', '203',
--                 '204', '205', '206', '207', '212', '213', '214', '218', '219', '220', '221', '223', '224', '225',
--                 '231', '232', '233', '234', '235', '236', '238', '239', '240', '241', '242', '244', '246', '247',
--                 '254', '255', '256', '257', '258', '259', '260', '262', '263', '264', '265', '266', '267', '272',
--                 '273', '274', '275', '276', '279', '280', '281', '282', '283', '284', '285', '291', '292', '293',
--                 '294', '295', '296', '297', '298', '299', '300', '301', '303', '304', '305', '306', '307', '309',
--                 '310', '311', '312', '313', '315', '316', '317', '318', '320', '321', '322', '323', '325', '326',
--                 '327', '328', '329', '332', '333', '335', '336', '337', '339', '340', '341', '342', '344', '345',
--                 '346', '347', '348', '349', '350', '707', '708', '710', '714', '715', '716', '717', '720', '721',
--                 '722', '723', '724', '725', '726', '727', '728', '729', '730', '731', '732', '733', '734', '735',
--                 '736', '737', '738', '739', '740', '741', '742', '745', '746', '748', '749', '751', '752', '753',
--                 '754'

--             )) OR 
--             (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_ITEM IN (
--                 '1634', '2068', '2069', '2070', '2071', '2072', '2073', '2074', '2075', '2077', '2078', '2079', '2080', '2081', '2082', '2083',
--                 '2084', '2086', '2087', '2088', '2089', '2090', '2091', '2092', '2093', '2094', '1675', '1677', '1678', '1681', '1682', '1683',
--                 '1684', '1685', '1687', '1688', '1689', '1690', '1692', '1695', '1696', '1697', '1698', '1699', '1700', '1701', '1702', '1703',
--                 '1704', '1706', '1707', '1708', '1709', '1710', '1711', '1712', '1713', '1714', '1715', '1716', '1717', '1719', '1720', '1723',
--                 '1725', '1726', '1729', '1730', '1731', '1732', '1733', '1734', '1735', '1738', '2095', '2096', '1745', '1746', '1748', '1749',
--                 '1750', '1751', '1752', '1753', '1754', '1756', '1757', '1758', '1759', '1760', '1761', '1763', '1764', '1765', '1766', '1767',
--                 '1768', '1769', '1770', '1771', '1772', '1774', '1775', '1776', '1777', '1778', '1779', '1780', '1781', '1782', '1783', '1785',
--                 '1791', '1792', '1793', '1795', '1796', '1797', '1798', '1799', '1800', '1801', '1803', '1804', '1805', '1806', '1808', '1810',
--                 '1811', '1813', '1814', '1815', '1816', '1818', '1821', '1822', '1823', '1824', '1826', '1829', '1830', '1832', '1835', '1836',
--                 '1837', '1839', '1842', '1843', '1844', '1845', '1847', '1849', '1850', '1851', '1853', '1854', '1855', '1856', '1858', '1859',
--                 '1860', '1861', '1862', '1863', '1864', '1865', '1866', '1867', '1868', '1869', '1870', '1871', '1872', '1876', '1877', '1878',
--                 '1881', '1882', '1883', '1884', '1885', '1886', '1887', '1888', '1890', '1891', '1894', '1895', '1896', '1897', '1898', '1899',
--                 '1900', '1902', '1903', '1904', '1905', '1908', '1911', '1913', '1914', '1915', '1916', '1917', '1918', '1920', '1921', '1922',
--                 '1923', '1924', '1925', '1926', '1928', '1929', '1930', '1931', '1932', '1933', '1934', '1935', '1937', '1939', '1940', '1941',
--                 '1943', '1944', '1945', '1946', '1947', '1948', '1949', '1951', '1953', '1955', '1956', '1957', '1958', '1959', '1961', '1964',
--                 '1965', '1966', '1968', '1969', '1971', '1974', '1975', '1976', '2097', '1978', '1981', '1982', '1983', '1984', '1985', '1991',
--                 '2099', '2100', '2101', '2102', '2103', '2104', '2105', '2106', '2108', '2109', '2110', '2111', '2112', '2113', '2114', '2115',
--                 '2117', '2118', '2119', '2120', '2121', '2122', '2123', '2124', '2125', '2032', '2034', '2035', '2038', '2039', '2040', '2041',
--                 '2042', '2043', '2044', '2045', '2046', '2048', '2049', '2052', '2054', '2055', '2058', '2059', '2060', '2061', '2062', '2063',
--                 '2064', '2065', '2066'

--             ))
-- 	)
--         THEN  NVL(V.NU_VALOR, 0)     
        
--         WHEN 
--             V.CO_TIPO IN ('2','3','4') --COLUNAS "Dedução de Transferências Const. e Legais a Municípios (b), Dedução de Transferências Const. e Legais a Municípios (d), Dedução de Transferências Const. e Legais a Municípios (g)"
--         AND 
--             ((V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_ITEM IN (
--                 '21','26','31','84','112','113','118','119','120','218','219',
--                 '220','231','232','234','254','255','257','708','710'
--             )) OR 
--             (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_ITEM IN (
--                 '2068','2069','2070','2071','2072','2073','2074','2075','2086','2087','2088','2089','2090','2091','2092','2093',
--                 '1706','1707','1708','1709','1710','1711','1712','2096','1745','1750','1751','1752','2099','2100','2101','2102',
--                 '2103','2104','2105','2106','2117','2118','2119','2120','2121','2122','2123','2124'

--             )
--         )
-- 	)
--         THEN  NVL(V.NU_VALOR, 0)     
        
--         WHEN 
--             V.CO_TIPO = 1 --COLUNA "Dedução Para Formação do FUNDEB (i)"
--         AND 
--             ((V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_ITEM IN (
--                 '21', '22', '26', '27', '31', '107', '112', '137', '212', '218', '219', '220',
--                 '231', '232', '233', '234', '254', '255', '256', '257', '708', '710'

--             )) OR 
--             (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_ITEM IN (
--                 '2068', '2069', '2070', '2071', '2072', '2073', '2074', '2075', '2077', '2078', 
--                 '2079', '2080', '2081', '2082', '2083', '2084', '2086', '2087', '2088', '2089', 
--                 '2090', '2091', '2092', '2093', '2094', '2095', '2096', '1770', '2099', '2100', 
--                 '2101', '2102', '2103', '2104', '2105', '2106', '2108', '2109', '2110', '2111', 
--                 '2112', '2113', '2114', '2115', '2117', '2118', '2119', '2120', '2121', '2122', 
--                 '2123', '2124', '2125'

--             )
--         )
-- 	)
--         THEN  NVL(V.NU_VALOR, 0)       
          
--     END = NVL(V.NU_VALOR, 0) )
--     AND V.CO_TIPO NOT IN ('21','23') -- TODOS ITENS DAS COLUNAS SÃO BLOQUEADOS OU SÃO CALCULADOS PELO SISTEMA (Receitas  Realizadas da  base para cálculo do percentual de aplicação em ASPS (h) = (e-f-g) e Total Geral das Receitas Líquidas Realizadas (j) = (e-f-g-i))
--     AND V.CO_UF != 53

-- UNION ALL


-- SELECT 
--     V.NU_ANO || CASE 
--         WHEN V.NU_PERIODO = '12' THEN '-1'
--         WHEN V.NU_PERIODO = '14' THEN '-2'
--         WHEN V.NU_PERIODO = '1'  THEN '-3'
--         WHEN V.NU_PERIODO = '18' THEN '-4'
--         WHEN V.NU_PERIODO = '20' THEN '-5'
--         WHEN V.NU_PERIODO = '2'  THEN '-6'
--     END AS "ANO-BIMESTRE",
--     V.CO_UF AS ENTE,
--     C.NO_COLUNA AS FASE,      
--     I.CO_ITEM_EXIBICAO AS CONTA, 
--     '' AS FONTE,
--     '' AS SUBFUCAO,
--     V.NU_VALOR AS VALOR_NOMINAL
-- FROM 
--     SIOPSUF.TB_VL_VALORES V
-- JOIN 
-- 	SIOPSUF.TB_PROJ_ITEM I ON V.CO_ITEM = I.CO_SEQ_ITEM
-- JOIN 
--     SIOPSUF.TB_PROJ_COLUNA C  ON V.CO_TIPO = C.CO_SEQ_COLUNA 
-- JOIN 
-- 	UltimaTransmissao U ON V.CO_UF = U.ENTE AND V.NU_ANO = U.NU_ANO AND V.NU_PERIODO = U.NU_PERIODO   
-- WHERE   
--     V.CO_PASTA = 1
--     AND (CASE        
--             WHEN V.CO_TIPO IN ('17','16','19','7','22') --COLUNAS "Previsão Inicial das Receitas Brutas (a), Previsão Atualizada das Receitas Brutas (c), Receitas  Realizadas Brutas (e),	Deduções das Receitas (f), Receitas Orçadas"
--             AND ((V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_ITEM IN (
--                 '16', '17', '19', '20', '21', '22', '23', '26', '27', '29', '30', '31', '34', '35', '36', '37', '38', '39', 
--                 '42', '44', '45', '46', '47', '48', '49', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', 
--                 '60', '61', '62', '63', '64', '65', '67', '69', '73', '74', '75', '76', '77', '78', '79', '80', '81', 
--                 '82', '83', '84', '85', '86', '87', '90', '91', '92', '93', '95', '96', '97', '98', '99', '100', '101', 
--                 '102', '107', '108', '109', '110', '111', '112', '113', '114', '116', '117', '118', '119', '120', '121', 
--                 '122', '124', '125', '126', '127', '128', '129', '130', '132', '133', '134', '135', '136', '137', '138', 
--                 '139', '140', '141', '142', '143', '149', '150', '151', '153', '154', '155', '156', '157', '158', '159', 
--                 '160', '161', '163', '164', '165', '166', '167', '168', '169', '170', '171', '173', '174', '175', '177', 
--                 '178', '179', '181', '182', '183', '184', '186', '187', '188', '191', '192', '194', '195', '196', '198', 
--                 '199', '200', '202', '203', '204', '205', '206', '207', '211', '212', '213', '214', '215', '216', '217', 
--                 '218', '219', '220', '221', '223', '224', '225', '227', '228', '229', '230', '231', '232', '233', '234', 
--                 '235', '236', '238', '239', '240', '241', '242', '244', '246', '247', '250', '251', '252', '253', '254', 
--                 '255', '256', '257', '258', '259', '260', '262', '263', '264', '265', '266', '267', '272', '273', '274', 
--                 '275', '276', '279', '280', '281', '282', '283', '284', '285', '291', '292', '293', '294', '295', '296', 
--                 '297', '298', '299', '300', '301', '303', '304', '305', '306', '307', '309', '310', '311', '312', '313', 
--                 '315', '316', '317', '318', '320', '321', '322', '323', '325', '326', '327', '328', '329', '332', '333', 
--                 '335', '336', '337', '339', '340', '341', '342', '344', '345', '346', '347', '348', '349', '350', '706', 
--                 '707', '708', '710', '711', '714', '715', '716', '717', '720', '721', '722', '723', '724', '725', '726', 
--                 '727', '728', '729', '730', '731', '732', '733', '734', '735', '736', '737', '738', '739', '740', '741', 
--                 '742', '745', '746', '748', '749', '751', '752', '753', '754'

--             )) OR 
--             (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_ITEM IN (
--                 '1632', '1634', '1638', '1639', '1640', '1641', '1642', '1643', '1644', '1645', '2068', '2069', '2070', 
--                 '2071', '2072', '2073', '2074', '2075', '2077', '2078', '2079', '2080', '2081', '2082', '2083', '2084', 
--                 '1647', '1648', '1649', '1650', '1651', '1652', '1653', '1654', '2086', '2087', '2088', '2089', '2090', 
--                 '2091', '2092', '2093', '2094', '1657', '1658', '1659', '1660', '1661', '1662', '1663', '1664', '1666', 
--                 '1667', '1668', '1669', '1670', '1671', '1672', '1673', '1674', '1675', '1677', '1678', '1681', '1682', 
--                 '1683', '1684', '1685', '1687', '1688', '1689', '1690', '1692', '1695', '1696', '1697', '1698', '1699', 
--                 '1700', '1701', '1702', '1703', '1704', '1706', '1707', '1708', '1709', '1710', '1711', '1712', '1713', 
--                 '1714', '1715', '1716', '1717', '1719', '1720', '1723', '1725', '1726', '1729', '1730', '1731', '1732', 
--                 '1733', '1734', '1735', '1738', '2095', '1741', '1742', '1743', '1744', '2096', '1745', '1746', '1748', 
--                 '1749', '1750', '1751', '1752', '1753', '1754', '1756', '1757', '1758', '1759', '1760', '1761', '1763', 
--                 '1764', '1765', '1766', '1767', '1768', '1769', '1770', '1771', '1772', '1774', '1775', '1776', '1777', 
--                 '1778', '1779', '1780', '1781', '1782', '1783', '1785', '1788', '1789', '1790', '1791', '1792', '1793', 
--                 '1795', '1796', '1797', '1798', '1799', '1800', '1801', '1803', '1804', '1805', '1806', '1808', '1810', 
--                 '1811', '1813', '1814', '1815', '1816', '1818', '1821', '1822', '1823', '1824', '1826', '1828', '1830', 
--                 '1832', '1835', '1836', '1837', '1839', '1842', '1843', '1844', '1845', '1847', '1849', '1850', '1851', 
--                 '1853', '1854', '1855', '1856', '1858', '1859', '1860', '1861', '1862', '1863', '1864', '1865', '1866', 
--                 '1867', '1868', '1869', '1870', '1871', '1872', '1876', '1877', '1878', '1881', '1882', '1883', '1884', 
--                 '1885', '1886', '1887', '1888', '1890', '1891', '1894', '1895', '1896', '1897', '1898', '1899', '1900', 
--                 '1902', '1903', '1904', '1905', '1908', '1910', '1913', '1914', '1915', '1916', '1917', '1918', '1920', 
--                 '1921', '1922', '1923', '1924', '1925', '1926', '1928', '1929', '1930', '1931', '1932', '1933', '1934', 
--                 '1935', '1936', '1938', '1940', '1941', '1942', '1943', '1944', '1945', '1946', '1947', '1948', '1949', 
--                 '1950', '1951', '1952', '1953', '1954', '1955', '1956', '1957', '1958', '1959', '1960', '1961', '1962', 
--                 '1963', '1964', '1965', '1966', '1967', '1968', '1969', '1970', '1971', '1972', '1973', '1974', '1975', 
--                 '1976', '1977', '1978', '1979', '1980', '1981', '1982', '1983', '1984', '1985', '1986', '1987', '1988', 
--                 '1989', '1990', '1991', '1992', '1993', '1994', '1995', '1996', '1997', '1998', '1999', '2000', '2001', 
--                 '2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013', '2014', 
--                 '2015', '2016', '2017'
--             ))
-- 	)
--         THEN  NVL(V.NU_VALOR, 0)        
        
--         WHEN 
--             V.CO_TIPO = 5 --COLUNA "Dedução Para Formação do FUNDEB (f)"
--         AND 
--             ((V.NU_ANO IN ('2018', '2019', '2020') AND V.CO_ITEM IN (
--             '16', '21', '22', '26', '27', '31', '107', '108', '111', '112', '137', '211', '212', '218', '219', 
--             '220', '227', '231', '232', '233', '234', '250',  '254', '255', '256', '257', '706', '708', '710'

--             )) OR 
--             (V.NU_ANO IN ('2021', '2022', '2023') AND V.CO_ITEM IN (
--                 '1632', '2068', '2069', '2070', '2071', '2072', '2073', '2074', '2075', '2077', '2078', '2079', 
--                 '2080', '2081', '2082', '2083', '2084', '2086', '2087', '2088', '2089', '2090', '2091', '2092', 
--                 '2093', '2094', '2095', '1741', '1744', '2096', '1770', '1989', '2099', '2100', '2101', '2102', 
--                 '2103', '2104', '2105', '2106', '2108', '2109', '2110', '2111', '2112', '2113', '2114', '2115', 
--                 '2117', '2118', '2119', '2120', '2121', '2122', '2123', '2124', '2125'      

--             )
--         )
-- 	)
--         THEN  NVL(V.NU_VALOR, 0)       
          
--     END = NVL(V.NU_VALOR, 0) )
--     AND V.CO_TIPO NOT IN ('21','23') -- TODOS ITENS DAS COLUNAS SÃO BLOQUEADOS OU SÃO CALCULADOS PELO SISTEMA (Receitas  Realizadas da  base para cálculo do percentual de aplicação em ASPS (e) = (c-d) e Total Geral das Receitas Líquidas Realizadas (g) = (c-d-f))
--     AND V.CO_UF = 53